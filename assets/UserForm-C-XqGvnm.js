import{bT as i,r as n,ar as r,as as I,ac as e,an as v,ae as o,ak as p}from"./index-3ac27fRG.js";import{S as f}from"./index-C7rAK8J3.js";import{S as F}from"./index-BP3h58-a.js";function k(a,d,t){return i.get(`/users?page=${a}&pageSize=${d}&username=${t}`)}function _(a){return i.post("/userSave",a)}function q(a){return i.post("/userDelete",a)}function L(a){return i.post("/userEnabled",a)}const{Option:w}=f,y=n.forwardRef(({onSuccess:a},d)=>{const[t]=r.useForm(),[u,c]=n.useState(!1),[h,b]=n.useState([]),[x,m]=n.useState(!1);n.useImperativeHandle(d,()=>({open:s=>{var l;t.resetFields(),s?t.setFieldsValue({...s,roleIds:((l=s.roleIds)==null?void 0:l.map(S=>S))||[]}):t.setFieldsValue({enabled:!0,roleIds:[]}),c(!0)}})),n.useEffect(()=>{u&&j()},[u]);const j=async()=>{const s=await I(1,9999,"");b(s.data)},g=async()=>{try{m(!0);const s=await t.validateFields(),l=await _(s);l.code===200?(p.success(l.message),c(!1),a()):p.error(l.message||"保存失败")}finally{m(!1)}};return e.jsx(v,{title:t.getFieldValue("id")?"编辑用户":"新增用户",open:u,onCancel:()=>c(!1),onOk:g,confirmLoading:x,width:500,destroyOnHidden:!0,children:e.jsxs(r,{form:t,labelCol:{span:5},children:[e.jsx(r.Item,{name:"id",hidden:!0,children:e.jsx(o,{})}),e.jsx(r.Item,{name:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"}],children:e.jsx(o,{placeholder:"请输入用户名"})}),e.jsx(r.Item,{name:"password",label:"密码",rules:[{required:!t.getFieldValue("id"),message:"请输入密码"}],children:e.jsx(o.Password,{placeholder:"请输入密码"})}),e.jsx(r.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e.jsx(o,{placeholder:"请输入昵称"})}),e.jsx(r.Item,{name:"roleIds",label:"分配角色",rules:[{required:!0,message:"请至少选择一个角色"}],children:e.jsx(f,{mode:"multiple",placeholder:"请选择角色",showSearch:!0,optionFilterProp:"label",children:h.map(s=>e.jsx(w,{value:s.id,label:s.name,children:s.name},s.id))})}),e.jsx(r.Item,{name:"enabled",label:"是否启用",valuePropName:"checked",children:e.jsx(F,{})})]})})}),P=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"}));export{y as U,P as _,L as a,q as b,k as u};
